if("undefined"==typeof jQuery)throw Error("bootstrap-imageupload's JavaScript requires jQuery.");!function(i){"use strict";var e={},n={init:t,disable:function i(){this.addClass("imageupload-disabled")},enable:a,reset:function i(){t.call(this,e)}};function t(n){e=i.extend({},i.fn.imageupload.defaultOptions,n);var t=this.find(".file-tab"),u=this.find(".panel-heading .btn:eq(0)"),p=t.find('input[type="file"]'),c=t.find(".btn:eq(1)"),m=this.find(".url-tab"),h=this.find(".panel-heading .btn:eq(1)"),b=m.find(".btn:eq(0)"),v=m.find(".btn:eq(1)");r(t),f(m),d(t),a.call(this),u.off(),p.off(),c.off(),h.off(),b.off(),v.off(),u.on("click",function(){i(this).blur(),d(t)}),p.on("change",function(){i(this).blur(),function n(t){var a=t.find(".btn:eq(0)"),d=t.find(".btn:eq(1)"),r=a.find("input");if(t.find(".alert").remove(),t.find("img").remove(),a.find("span").text("Browse"),d.hide(),r[0].files&&r[0].files[0]){a.prop("disabled",!0);var f=r[0].files[0];!function n(t,a){if(t.size/1024>e.maxFileSizeKb){a(!1,"File is too large (max "+e.maxFileSizeKb+"kB).");return}var l=s(t.name);i.inArray(l,e.allowedFormats)>-1?a(!0,"Image file is valid."):a(!1,"File type is not allowed.")}(f,function(i,e){if(i){var n=new FileReader;n.onload=function(i){t.prepend(o(i.target.result)),a.find("span").text("Change"),d.css("display","inline-block")},n.onerror=function(){t.prepend(l("Error loading image file.")),r.val("")},n.readAsDataURL(f)}else t.prepend(l(e)),a.find("span").text("Browse"),r.val("");a.prop("disabled",!1)})}}(t)}),c.on("click",function(){i(this).blur(),r(t)}),h.on("click",function(){i(this).blur(),function i(e){var n=e.closest(".imageupload"),t=n.find(".panel-heading .btn:eq(1)");if(!t.hasClass("active")){var a=n.find(".file-tab");n.find(".panel-heading .btn:eq(0)").removeClass("active"),t.addClass("active"),a.hide(),e.show(),r(a)}}(m)}),b.on("click",function(){i(this).blur(),function n(t){var a,d,r,f,u,p=t.find('input[type="text"]'),c=t.find(".btn:eq(0)"),m=t.find(".btn:eq(1)");t.find(".alert").remove(),t.find("img").remove(),m.hide();var h=p.val();if(!h){t.prepend(l("Please enter an image URL."));return}p.prop("disabled",!0),c.prop("disabled",!0),a=h,d=function(e,n){e?(t.find('input[type="hidden"]').val(h),i(o(h)).insertAfter(c.closest(".input-group")),m.css("display","inline-block")):t.prepend(l(n)),p.prop("disabled",!1),c.prop("disabled",!1)},r=null,f=!1,(u=new Image).onload=function(){if(!f){window.clearTimeout(r);var n=a;-1!==n.indexOf("?")&&(n=n.split("?")[0].split("#")[0]);var t=s(n);i.inArray(t,e.allowedFormats)>-1?d(!0,"Image URL is valid."):d(!1,"File type is not allowed.")}},u.onerror=function(){f||(window.clearTimeout(r),d(!1,"Image could not be found."))},u.src=a,r=window.setTimeout(function(){f=!0,u.src="???",d(!1,"Loading image timed out.")},3e3)}(m)}),v.on("click",function(){i(this).blur(),f(m)})}function a(){this.removeClass("imageupload-disabled")}function l(i){var e=[];return e.push('<div class="alert alert-danger alert-dismissible">'),e.push('<button type="button" class="close" data-dismiss="alert">'),e.push("<span>&times;</span>"),e.push("</button>"+i),e.push("</div>"),e.join("")}function o(i){return'<img src="'+i+'" alt="Image preview" class="img-thumbnail" style="object-fit: cover; max-width: '+e.maxWidth+"px; max-height: "+e.maxHeight+'px">'}function s(i){return i.substr(i.lastIndexOf(".")+1).toLowerCase()}function d(i){var e=i.closest(".imageupload"),n=e.find(".panel-heading .btn:eq(0)");if(!n.hasClass("active")){var t=e.find(".url-tab");e.find(".panel-heading .btn:eq(1)").removeClass("active"),n.addClass("active"),t.hide(),i.show(),f(t)}}function r(i){i.find(".alert").remove(),i.find("img").remove(),i.find(".btn span").text("Browse"),i.find(".btn:eq(1)").hide(),i.find("input").val("")}function f(i){i.find(".alert").remove(),i.find("img").remove(),i.find(".btn:eq(1)").hide(),i.find("input").val("")}i.fn.imageupload=function(e){var t=arguments;return this.filter("div").each(function(){if(n[e])n[e].apply(i(this),Array.prototype.slice.call(t,1));else if("object"!=typeof e&&e)throw Error('Method "'+e+'" is not defined for imageupload.');else n.init.apply(i(this),t)})},i.fn.imageupload.defaultOptions={allowedFormats:["jpg","jpeg","png","gif"],maxWidth:"100%",maxHeight:"100%",maxFileSizeKb:2048}}(jQuery);